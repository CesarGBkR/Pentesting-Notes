# か Information disclosure vulnerabilities

<div align="center">

<img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSwrYxJeahR9_oCFquK0xWL2NrSjo-JsQmflg&#x26;s" alt="" height="200" width="200">

</div>

## Information disclosure

_Information disclosure_ o en espa帽ol, Divulgaci贸n de informaci贸n, tambi茅n conocido como _information leakage_ o fuga de informaci贸n, se le denomina a la acci贸n de un sitio web de revelar informaci贸n sensible de manera in intencionada a sus usuarios. Dependiendo el escenario, esta informaci贸n puede ser usada para vulnerar el sitio o revelar informaci贸n sensible de los usuarios. La informaci贸n catalogada como sensible incluye:

* Datos sobre otros usuarios, como usernames o informaci贸n financiera
* Datos sensibles sobre el negocio o datos comerciales sensibles
* Detalles t茅cnicos sobre el sitio web y su infraestructura Dicha informaci贸n puede ser de baja relevancia pero con potencial de ser usada para escalar en un ataque m谩s complejo. Una de las formas m谩s comunes de lograr observar informaci贸n sensible no intencionada de mostrar puede ser el interactuar de forma no esperada con el sitio o directamente de una forma mal intencionada. Se sugiere tener especial atenci贸n en las respuestas otorgadas por el sitio, esperando comportamientos fuera de lo esperado que contengan informaci贸n primordial para seguir buscando, o directamente los datos sensibles buscados.

### Ejemplos de information disclosure

Ejemplos:

* Revelaci贸n de datos del sistema como _usernames, passwords, access keys, encription keys_, etc.
* Exponer c贸digo fuente, archivos de configuraci贸n u otros detalles internos de la aplicaci贸n
* Divulgaci贸n de datos que sean de ayuda para un atacante
* Filtrado ineficiente de entradas y salidas de texto o archivos
* Insuficientes revisiones de autorizaci贸n
* Falla para manejar propiamente excepciones y errores
* Filtrado de datos de practicas de seguridad
* Malas configuraciones o componentes de software desactualizado o vulnerables
* Revelar nombres de directorios ocultos, su estructura y su contenido v铆a archivos _robots.txt_ o listado de directorios
* Proveer acceso a c贸digo fuente v铆a respaldos temporales
* Menci贸n explicita a nombres de bases de datos, tablas o columnas en mensajes de error
* Exposici贸n innecesaria de informaci贸n sensible como detalles de tarjetas de cr茅dito
* Exposici贸n explicita de _API keys, direcciones IP, credenciales de bases de datos_ y dem谩s dentro del c贸digo fuente
* Revelaci贸n de informaci贸n que nos puede llevar a inferir o suponer la existencia o ausencia de recursos, _usernames_ y dem谩s por medio de sutiles diferencias en el comportamiento de la aplicaci贸n

### Causas

La divulgaci贸n de datos sensibles ocurre de una gran cantidad de formas, pero estas pueden ser organizadas como

* Fallo en remover contenido interno para el publico Por ejemplo, comentarios realizados por desarrolladores que son visibles para los usuarios en el ambiente de producci贸n
* Configuraciones inseguras de el sitio web y tecnolog铆as relacionadas Fallando en des-habilitar herramientas de depuraci贸n o funciones de diagnostico que pueden proveer a los atacantes herramientas 煤tiles para obtener informaci贸n sensible. Configuraciones por defecto tambi茅n pueden dejar vulnerable el sitio web por ejemplo mostrando mensajes de error muy informativos
* Dise帽o y comportamiento defectuoso de la aplicaci贸n Si un sitio web retorna respuestas distintas cuando diferentes estados de error ocurren, esto puede tambi茅n permitir a los atacantes enumerar datos sensibles como credenciales de usuario v谩lidas

### Impacto en el negocio

La relevancia para un negocio en evadir tener este tipo de vulnerabilidad se basa en el impacto negativo que puede tener para un negoci贸, potencialmente impactando en **Perdidas financieras, Da帽o a la reputaci贸n, Perturbaci贸n del negoci贸, Violaciones de incumplimiento**.

#### Perdidas financieras

* Exposici贸n de datos sensibles como secretos comerciales, propiedad intelectual o informaci贸n del consumidor que puede directamente encabezar perdidas econ贸micas y generar desventaja competitiva
* Penalidades por violaci贸n a la privacidad de la informaci贸n en leyes como la GDPR o HIPPA
* Costos de respuesta a incidentes de seguridad, notificaciones al consumidor, cuotas legales, etc

#### Da帽o a la reputaci贸n

* Perdidas de confianza por parte del consumidor que desemboquen en perdidas de clientes o en dificultades para atraer nuevos clientes
* Da帽o a la reputaci贸n de la marca y percepci贸n p煤blica de las pr谩cticas de seguridad de la compa帽铆a
* Atenci贸n negativa de los medios de comunicaci贸n en torno a el filtrado de informaci贸n

#### Perturbaci贸n del negocio

* Que la informaci贸n divulgada fuerce al negocio a la inactividad por la respuesta al incidente
* Dejar fuera de funci贸n aplicaciones cr铆ticas y servicios mientras la vulnerabilidad es remediada
* Perdidas de productividad tratando con el incidente de seguridad

#### Violaciones de incumplimiento

* Filtraci贸n de datos regulados como formas de pago e historiales de salud que pueden resultar en penalidades de incumplimiento
* Potenciales auditorias gubernamentales e incremento en pr谩cticas de seguridad

## **Explotaci贸n**

Es indispensable para el investigador evitar la _vision de tuner_ durante las pruebas. En otras palabras, es importante evitar enfocarse de m谩s en una vulnerabilidad particular. La informaci贸n sensible puede filtrarse en todo tipo de lugares, puedes encontrarte con informaci贸n sensible probando algo m谩s, como puede pasar durante pruebas en otro tipo de vulnerabilidades. Una habilidad clave es ser capaz de reconocer informaci贸n relevante cuando sea y donde sea que vayas.

### Herramientas y t茅cnicas

#### _Fuzzing_

En el caso de que identifiques par谩metros interesantes, puedes tratar de mandar tipos de datos no esperados y _strings_ siguiendo preferentemente par谩metros espec铆ficos para el objetivo o con par谩metros basados en resultados previos, en conjunto con el _fuzzing_. Pon suma atenci贸n; por medio de las respuestas algunas veces revelan de forma explicita informaci贸n interesante, tambi茅n pueden dar pistas del comportamiento de la aplicaci贸n. Esto puede estar en una sutil diferencia de tiempo de respuesta . A煤n si el contenido de un error no revela nada, el hecho es que algunas veces el encontrar un caso de error en lugar de otro es una informaci贸n 煤til en s铆 misma. Existe la posibilidad de automatizar en mayor medida este proceso usando herramientas como _Burp Intruder_. Esto provee varios beneficios entre los que destacan:

* Agregar un _payload_ posicional a un par谩metro y usar listas de palabras previamente hechas o _fuzz strings_ para probar un alto volumen de diferentes entradas en una r谩pida sucesi贸n.
* F谩cil identificaci贸n de diferencias en respuestas por comparaci贸n de c贸digos de estado HTTP, tiempos de respuesta, longitud de respuesta, entre otros.
* Uso de reglas de coincidencia usando herramientas como _grep_ para identificar prontamente palabras clave, como _error, valid, SELECT, SQL,_ entre otras.
* Aplicar reglas de extracci贸n con _grep_ para obtener y comparar contenido de elementos interesantes entre respuestas Es posible tambi茅n usar la extensi贸n _Logger++_, disponible en la _BApp store_. En adici贸n a peticiones de _logging_, y respuestas de todas las herramientas de _Burpsuite_. Permitiendo definir avanzados filtros para remarcar entradas de inter茅s.

#### Burp Scanner (No disponible en version comunitaria)

Provee un scanner en vivo para auditar elementos por medio de tu buscador, o tu puedes agendar escaneos autom谩ticos para rastrear y auditar el sitio objetivo por tu cuenta. Ambos m茅todos marcar谩n de forma autom谩tica algunas vulnerabilidades de divulgaci贸n de la informaci贸n por ti.

#### Burp engagement tools

Burp provee varias herramientas que puedes usar para encontrar informaci贸n interesante en el sitio web objetivo de forma m谩s sencilla. Puedes acceder a las herramientas desde el men煤 de contexto haciendo _click_ en cualquier mensaje HTTP, entrada tipo _Burp Proxy_, o elemento en el _site map_ e ir a _Engagement tools_. Las siguientes herramientas son particularmente 煤tiles en este contexto.

* **Search** Puedes usar esta herramienta para revisar cualquier expresi贸n con el elemento seleccionado. Puedes refinar los resultados usando varias opciones de b煤squeda avanzadas, como _regex_ 贸 _negative search_. Esto es 煤til para un r谩pido descubrimiento de ocurrencias 贸 en su defecto, abstinencias de palabras clave en el elemento de inter茅s
* **Find comments** Puedes usar esta herramienta para extraer de forma r谩pida cualquier comentario dejado por un desarrollador en el elemento seleccionado. Esto tambi茅n provee pesta帽as para acceder de manera instant谩nea al ciclo de respuesta/petici贸n HTTP en cada uno donde se encontr贸.
* **Discover content** Puedes usar esta herramienta para identificar contenido adicional y funcionalidad que no es enlazada desde el contenido visible del sitio web. Este caso puede ser 煤til para encontrar directorios adicionales y archivos que no necesariamente aparecen en el _site map_ de forma autom谩tica.

#### Ingenier铆a de respuestas informativas

Los mensajes de error demasiado informativos algunas veces pueden divulgar informaci贸n interesante mientras t煤 vas sobre tu flujo de trabajo habitual. Sin embargo, mediante el estudio en la manera de que los mensajes de error cambian seg煤n tu entrada, puedes tomar esto un paso m谩s all谩. En algunos casos, tu podr谩s manipular el sitio web para extraer de forma arbitraria informaci贸n por un mensaje de error. Hay numerosos m茅todos para hacer esto, dependiendo del escenario particular en el que te encuentres. Un ejemplo com煤n es hacer que la l贸gica de ta aplicaci贸n intente una acci贸n invalidad en un elemento espec铆fico de informaci贸n. Por ejemplo, enviando un valor inv谩lido a un par谩metro puede dar lugar a un mensaje de seguimiento del error o una respuesta de depuraci贸n que contiene informaci贸n interesante.

## Prevenci贸n

Dada la naturaleza de la vulnerabilidad y sus m煤ltiples formas de ser expuesta, puede resultar algo complejo el abarcar en su totalidad las formas de prevenci贸n. Algunas de las pr谩cticas generales que se pueden seguir para minimizar el riesgo de este tipo de vulnerabilidades son

* Tener certeza de que todos los involucrados en el desarrollo del sitio est谩n completamente advertidos de cual tipo de informaci贸n es considerada sensible. Algunas veces aparenta ser informaci贸n inofensiva pero es informaci贸n que puede ser de mayor utilidad para un atacante de lo que aparenta
* Auditar cualquier c贸digo que potencialmente divulgue informaci贸n sensible como parte de las actividades del QA o proceso de construcci贸n. Esto puede ser relativamente f谩cil de automatizar para algunas tareas
* Uso de mensajes de error gen茅ricos en la mayor medida que sea posible, as铆 los atacantes no son provistos de informaci贸n que otorgue pistas sobre el comportamiento de la aplicaci贸n de forma innecesaria
* Revisi贸n doble de que cualquier herramienta de diagnostico o depuraci贸n est谩 des-habilitada en el entorno productivo
* Asegura el completo entendimiento de las configuraciones e implicaciones de seguridad de cualquier tecnolog铆a de terceros que implemente. Toma el tiempo para investigar cualquier funci贸n no deseable y las configuraciones que actualmente necesitas

## Refrences

[https://portswigger.net/web-security/information-disclosure ](https://portswigger.net/web-security/information-disclosure)

[https://www.hackerone.com/vulnerability-management/information-disclosure-deep-dive](https://www.hackerone.com/vulnerability-management/information-disclosure-deep-dive)
